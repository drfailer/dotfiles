#!/bin/bash

set -euo pipefail

# secify directory and collect options
chose_files() {
  case $1 in
    do) echo $(fzf --walker-root="~/Downloads/") ;;
    dc) echo $(fzf --walker-root="~/Documents/") ;;
    de) echo $(fzf --walker-root="~/Desktop/") ;;
    c) echo $(fzf --walker-root="~/.config/") ;;
    l) echo $(fzf --walker-root="~/.local/") ;;
    *)
      if [ -d $1 ]; then
        echo $(ls -d $1* | fzf -m) # we don't list recursively here
      else
        echo $(fzf --walker-root="$HOME")
      fi
      ;;
  esac
}

# the user can specify a location
if [ $# -eq 2 ]; then
  location="$2/"
else
  location=none
fi

# handle main options
case $1 in
  mv) # move the chosen files
    choices=$(chose_files $location)
    for c in $choices; do
      mv $c $PWD
    done
    ;;
  cp) # copy the chosen files
    choices=$(chose_files $location)
    for c in $choices; do
      cp -r $c $PWD
    done
    ;;
  cd)
    echo $(fzf --walker=dir)
    ;;
  *) echo "ERROR: unknown option." ;;
esac
